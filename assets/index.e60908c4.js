import{j as C,r as I,u as P,a as R}from"./vendor.a536db46.js";const k=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const r of e.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function i(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?e.credentials="include":t.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(t){if(t.ep)return;t.ep=!0;const e=i(t);fetch(t.href,e)}};k();/**
 * @preserve
 * Copyright 2015 Igor Bezkrovny
 * All rights reserved. (MIT Licensed)
 *
 * ssim.ts - part of Image Quantization Library
 */const O=4;function q(n,s,i=8,a=.01,t=.03,e=!0,r=8){if(n.width!==s.width||n.height!==s.height)throw new Error("Images have different sizes!");const l=(1<<r)-1,h=Math.pow(a*l,2),g=Math.pow(t*l,2);let p=0,c=0,f=0;function d(x,y,w,o){let u,b,v;u=b=v=0;for(let M=0;M<x.length;M++)b+=Math.pow(x[M]-w,2),v+=Math.pow(y[M]-o,2),u+=(x[M]-w)*(y[M]-o);const _=x.length-1;b/=_,v/=_,u/=_;const L=(2*w*o+h)*(2*u+g),N=(Math.pow(w,2)+Math.pow(o,2)+h)*(b+v+g);c+=L/N,f+=(2*u+g)/(b+v+g),p++}return j._iterate(n,s,i,e,d),{ssim:c/p,mcs:f/p}}var j;(n=>{function s(t,e,r,l,h){const g=t.width,p=t.height;for(let c=0;c<p;c+=r)for(let f=0;f<g;f+=r){const d=Math.min(r,g-f),x=Math.min(r,p-c),y=i(t,f,c,d,x,l),w=i(e,f,c,d,x,l),o=a(y),u=a(w);h(y,w,o,u)}}n._iterate=s;function i(t,e,r,l,h,g,p=O){const c=t.data,f=new Float32Array(new ArrayBuffer(l*h*4));let d=0;const x=r+h;for(let y=r;y<x;y++){const w=y*t.width;let o=(w+e)*p;const u=(w+e+l)*p;switch(p){case 1:for(;o<u;)f[d++]=c[o++];break;case 2:for(;o<u;)f[d++]=c[o++]*(c[o++]/255);break;case 3:if(g)for(;o<u;)f[d++]=c[o++]*.212655+c[o++]*.715158+c[o++]*.072187;else for(;o<u;)f[d++]=c[o++]+c[o++]+c[o++];break;case 4:if(g)for(;o<u;)f[d++]=(c[o++]*.212655+c[o++]*.715158+c[o++]*.072187)*(c[o++]/255);else for(;o<u;)f[d++]=(c[o++]+c[o++]+c[o++])*(c[o++]/255);break}}return f}function a(t){let e=0;for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}})(j||(j={}));const m=1024,W=20;function F(){const n=document.createElement("canvas");return n.width=m,n.height=m,n.getContext("2d")}function B(n){return S(n,{x:0,y:0,width:m,height:m})}function S(n,{x:s,y:i,width:a,height:t}){return new Promise(e=>{const r=new Image;r.onload=()=>{const l=F();l.drawImage(r,0,0,m,m);const h=l.getImageData(s,i,a,t);e(h)},r.src=n})}function T(n){return`face-${n}.jpg`}function H(n){const s=F(),i=n.length,a=Z(i),t=a.map((e,r)=>S(T(n[r]),e));return Promise.all(t).then(e=>{for(let r=0;r<i;r++){const{y:l,x:h}=a[r];s.putImageData(e[r],h,l)}return s})}function Z(n){const s=Math.sqrt(n),i=m/s;return Array.from({length:n}).map((a,t)=>{const e=Math.floor(t/s),r=t%s;return{x:e*i,y:r*i,width:i,height:i}})}function G(n,s){return Math.floor(Math.random()*(s-n+1))+n}function A(){return G(1,W)}function K(){return[A(),A(),A(),A()]}const E=C.exports.jsx,D=C.exports.jsxs,U=C.exports.Fragment;function Y({draw:n,scale:s=1}){const i=I.exports.useRef(null);return I.exports.useEffect(()=>{const a=i.current;if(a===null)return;const t=a.getContext("2d");t.scale(s,s),n(t),t.resetTransform()},[i]),E("canvas",{ref:i,width:m*s,height:m*s})}const $=.5;function J(){const[n,s]=I.exports.useState(),[i,a]=P(async()=>[await H(K()),await B("face-2.jpg")]),t=I.exports.useCallback(e=>{e.drawImage(i.canvas,0,0)},[]);return I.exports.useEffect(()=>{const e=i.getImageData(0,0,m,m);s(q(e,a))},[a]),D(U,{children:[D("h2",{children:["Result ",n==null?void 0:n.ssim]}),E(Y,{draw:t,scale:$})]})}R.exports.render(E(I.exports.StrictMode,{children:E(I.exports.Suspense,{fallback:E("div",{children:"loading..."}),children:E(J,{})})}),document.getElementById("root"));
