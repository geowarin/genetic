var K=Object.defineProperty,$=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var C=(e,t,a)=>t in e?K(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,D=(e,t)=>{for(var a in t||(t={}))Q.call(t,a)&&C(e,a,t[a]);if(q)for(var a of q(t))X.call(t,a)&&C(e,a,t[a]);return e},R=(e,t)=>$(e,J(t));import{j as A,r as P,n as Y,a as O,u as V,c as z,b as ee}from"./vendor.e497214e.js";const te=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}};te();const f=1024,ne=20,F=10,T=9,ae=4,B=5,l=A.exports.jsx,x=A.exports.jsxs,oe=A.exports.Fragment;function re({image:e,scale:t=1}){const a=P.exports.useRef(null);return P.exports.useEffect(()=>{const s=a.current;if(s===null)return;const n=s.getContext("2d");n.scale(t,t),n.drawImage(e.canvas,0,0),n.resetTransform()},[a]),l("canvas",{ref:a,width:f*t,height:f*t})}function L(){const e=document.createElement("canvas");return e.width=f,e.height=f,e.getContext("2d")}function se(e){return W(e,{x:0,y:0,width:f,height:f})}function W(e,{x:t,y:a,width:s,height:n}){return new Promise(o=>{const r=new Image;r.onload=()=>{const u=L();u.drawImage(r,0,0,f,f);const h=u.getImageData(t,a,s,n);o(h)},r.src=e})}function ie(e){return`face-${e}.jpg`}function ce(e){const t=L(),a=e.length,s=le(a),n=s.map((o,r)=>W(ie(e[r]),o));return Promise.all(n).then(o=>{for(let r=0;r<a;r++){const{y:u,x:h}=s[r];t.putImageData(o[r],h,u)}return t})}function le(e){const t=Math.sqrt(e),a=f/t;return Array.from({length:e}).map((s,n)=>{const o=Math.floor(n/t),r=n%t;return{x:o*a,y:r*a,width:a,height:a}})}function ue(e){return e.getImageData(0,0,f,f)}/**
 * @preserve
 * Copyright 2015 Igor Bezkrovny
 * All rights reserved. (MIT Licensed)
 *
 * ssim.ts - part of Image Quantization Library
 */const pe=3;function he(e,t,a=8,s=.01,n=.03,o=!0,r=8){if(e.width!==t.width||e.height!==t.height)throw new Error("Images have different sizes!");const u=(1<<r)-1,h=Math.pow(s*u,2),g=Math.pow(n*u,2);let b=0,c=0,p=0;function m(y,k,w,i){let d,I,N;d=I=N=0;for(let v=0;v<y.length;v++)I+=Math.pow(y[v]-w,2),N+=Math.pow(k[v]-i,2),d+=(y[v]-w)*(k[v]-i);const M=y.length-1;I/=M,N/=M,d/=M;const Z=(2*w*i+h)*(2*d+g),U=(Math.pow(w,2)+Math.pow(i,2)+h)*(I+N+g);c+=Z/U,p+=(2*d+g)/(I+N+g),b++}return j._iterate(e,t,a,o,m),{ssim:c/b,mcs:p/b}}var j;(e=>{function t(n,o,r,u,h){const g=n.width,b=n.height;for(let c=0;c<b;c+=r)for(let p=0;p<g;p+=r){const m=Math.min(r,g-p),y=Math.min(r,b-c),k=a(n,p,c,m,y,u),w=a(o,p,c,m,y,u),i=s(k),d=s(w);h(k,w,i,d)}}e._iterate=t;function a(n,o,r,u,h,g,b=pe){const c=n.data,p=new Float32Array(new ArrayBuffer(u*h*4));let m=0;const y=r+h;for(let k=r;k<y;k++){const w=k*n.width;let i=(w+o)*b;const d=(w+o+u)*b;switch(b){case 1:for(;i<d;)p[m++]=c[i++];break;case 2:for(;i<d;)p[m++]=c[i++]*(c[i++]/255);break;case 3:if(g)for(;i<d;)p[m++]=c[i++]*.212655+c[i++]*.715158+c[i++]*.072187;else for(;i<d;)p[m++]=c[i++]+c[i++]+c[i++];break;case 4:if(g)for(;i<d;)p[m++]=(c[i++]*.212655+c[i++]*.715158+c[i++]*.072187)*(c[i++]/255);else for(;i<d;)p[m++]=(c[i++]+c[i++]+c[i++])*(c[i++]/255);break}}return p}function s(n){let o=0;for(let r=0;r<n.length;r++)o+=n[r];return o/n.length}})(j||(j={}));const de=["aardvark","abacus","abundance","ache","acupuncture","airbrush","alien","anagram","angle","amazing","ankle","alphabet","antenna","aqua","asphalt","bacon","banana","bangles","banjo","bankrupt","bar","barracuda","basket","beluga","binder","birthday","bisect","blizzard","blunderbuss","boa","bog","bounce","broomstick","brought","bubble","budgie","bug","bug-a-boo","bugger","buff","burst","butter","buzz","cabana","cake","calculator","camera","candle","carnival","carpet","casino","cashew","catfish","ceiling","celery","chalet","chalk","chart","cheddar","chesterfield","chicken","chinchill","chit-chat","chocolate","chowder","coal","compass","compress","computer","conduct","contents","cookie","copper","corduroy","cow","cracker","crackle","croissant","cube","cupcake","curly","curtain","cushion","cuticle","daffodil","delicious","dictionary","dimple","ding-a-ling","disk","disco duck","dodo","dolphin","dong","donuts","dork","dracula","duct tape","effigy","egad","elastic","elephant","encasement","erosion","eyelash","fabulous","fantastic","feather","felafel","fetish","financial","finger","finite","fish","fizzle","fizzy","flame","flash","flavour","flick","flock","flour","flower","foamy","foot","fork","fritter","fudge","fungus","funny","fuse","fusion","fuzzy","garlic","gelatin","gelato","ghetto","glebe","glitter","glossy","groceries","goulashes","guacamole","gumdrop","haberdashery","hamster","happy","highlight","hippopotamus","hobbit","hold","hooligan","hydrant","icicles","idiot","implode","implosion","indeed","issue","itchy","jell-o","jewel","jump","kabob","kasai","kite","kiwi","ketchup","knob","laces","lacy","laughter","laundry","leaflet","legacy","leprechaun","lollypop","lumberjack","macadamia","magenta","magic","magnanimous","mango","margarine","massimo","mechanical","medicine","meh","melon","meow","mesh","metric","microphone","minnow","mitten","mozzarella","muck","mumble","mushy","mustache","nanimo","noodle","nostril","nuggets","oatmeal","oboe","o'clock","octopus","odour","ointment","olive","optic","overhead","ox","oxen","pajamas","pancake","pansy","paper","paprika","parmesan","pasta","pattern","pecan","peek-a-boo","pen","pepper","pepperoni","peppermint","perfume","periwinkle","photograph","pie","pierce","pillow","pimple","pineapple","pistachio","plush","polish","pompom","poodle","pop","popsicle","prism","prospector","prosper","pudding","puppet","puzzle","queer","query","radish","rainbow","ribbon","rotate","salami","sandwich","saturday","saturn","saxophone","scissors","scooter","scrabbleship","scrunchie","scuffle","shadow","sickish","silicone","slippery","smash","smooch","snap","snooker","socks","soya","spaghett","sparkle","spatula","spiral","splurge","spoon","sprinkle","square","squiggle","squirrel","statistics","stuffing","sticky","sugar","sunshine","super","swirl","taffy","tangy","tape","tat","teepee","telephone","television","thinkable","tip","tof","toga","trestle","tulip","turnip","turtle","tusks","ultimate","unicycle","unique","uranus","vegetable","waddle","waffle","wallet","walnut","wagon","window","whatever","whimsical","wobbly","yellow","zap","zebra","zigzag","zip"];function G(e,t){return Math.floor(Math.random()*(t-e+1))+e}function me(){return G(1,ne)}function E(e){return e[G(0,e.length-1)]}function fe(){return E(de)}function S(e){return Array.from({length:e})}function ge(){return S(T).map(me)}function be(){const e=S(F).map(ge);return Promise.all(e.map(t=>H(fe(),t)))}function H(e,t){return ce(t).then(a=>({face:a,chromosome:t,id:Y(),name:e}))}function we(e){return t=>t.map(a=>R(D({},a),{rating:e(a)}))}function ye(e){return t=>{const a=ue(t.face);return he(a,e).ssim}}function ke(e){return O(e).sortedByDescending(t=>t.rating).take(ae).toArray()}async function xe(e){const t=O(e).chunk(2).flatMap(([a,s])=>{const n=S(T).map((u,h)=>Math.random()>.5?a.chromosome[h]:s.chromosome[h]),o=E(a.name.split(" ")),r=E(s.name.split(" "));return H(o+" "+r,n)});return Promise.all(t)}function ve(e){return O(e).sortedByDescending(t=>t.rating).take(F).toArray()}function Ie(e){return[]}async function Ne(e,t){const a=e(t),s=ke(a),n=e(await xe(s)),o=e(Ie()),r=ve([...a,...o,...n]);return{population:a,selected:s,children:n,mutants:o,newPopulation:r}}async function Pe(e=1){const t=await se("face-2.jpg"),a=await be(),s=we(ye(t)),n=[];let o=a;for(let r=0;r<e;r++){const u=await Ne(s,o);n.push(u),o=u.newPopulation}return n}function Me(){const[e,t]=P.exports.useState(0),s=V(()=>Pe(B))[e];return x(oe,{children:[x("h2",{children:["Generation ",e]}),l("div",{children:l("input",{type:"range",min:"0",max:B-1,value:e,onChange:n=>t(parseInt(n.target.value))})}),x("div",{className:"result-container",children:[x("div",{className:"results",style:{maxWidth:"50%"},children:[l("h2",{children:"Population"}),l("div",{className:"portraits",children:s.population.map(n=>l(_,{person:n,className:z({selected:s.newPopulation.includes(n)})},n.id))})]}),x("div",{className:"results",style:{maxWidth:"25%"},children:[l("h2",{children:"Children"}),l("div",{className:"portraits",children:s.children.map(n=>l(_,{person:n,className:z({selected:s.newPopulation.includes(n)})},n.id))})]}),l("h2",{children:"Mutants"}),l("div",{className:"portraits",children:s.mutants.map(n=>l(_,{person:n,className:z({selected:s.newPopulation.includes(n)})},n.id))})]})]})}function _({person:e,className:t}){return x("div",{className:"portrait "+t,children:[l(re,{image:e.face,scale:.2}),l("span",{children:e.name}),x("span",{children:[Math.ceil(e.rating*1e4)/100,"%"]})]})}ee.exports.render(l(P.exports.StrictMode,{children:l(P.exports.Suspense,{fallback:l("div",{children:"loading..."}),children:l(Me,{})})}),document.getElementById("root"));
