import{j as _,r as v,u as L,a as R}from"./vendor.a536db46.js";const k=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function c(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerpolicy&&(r.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?r.credentials="include":e.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(e){if(e.ep)return;e.ep=!0;const r=c(e);fetch(e.href,r)}};k();const d=1024,B=20,I=_.exports.jsx,F=_.exports.jsxs,W=_.exports.Fragment;function S({image:t,scale:n=1}){const c=v.exports.useRef(null);return v.exports.useEffect(()=>{const a=c.current;if(a===null)return;const e=a.getContext("2d");e.scale(n,n),e.drawImage(t.canvas,0,0),e.resetTransform()},[c]),I("canvas",{ref:c,width:d*n,height:d*n})}function q(t,n){return Math.floor(Math.random()*(n-t+1))+t}function T(){return q(1,B)}function j(){const t=document.createElement("canvas");return t.width=d,t.height=d,t.getContext("2d")}function H(t){return C(t,{x:0,y:0,width:d,height:d})}function C(t,{x:n,y:c,width:a,height:e}){return new Promise(r=>{const o=new Image;o.onload=()=>{const l=j();l.drawImage(o,0,0,d,d);const m=l.getImageData(n,c,a,e);r(m)},o.src=t})}function Z(t){return`face-${t}.jpg`}function G(t){const n=j(),c=t.length,a=U(c),e=a.map((r,o)=>C(Z(t[o]),r));return Promise.all(e).then(r=>{for(let o=0;o<c;o++){const{y:l,x:m}=a[o];n.putImageData(r[o],m,l)}return n})}function U(t){const n=Math.sqrt(t),c=d/n;return Array.from({length:t}).map((a,e)=>{const r=Math.floor(e/n),o=e%n;return{x:r*c,y:o*c,width:c,height:c}})}function K(t){return t.getImageData(0,0,d,d)}/**
 * @preserve
 * Copyright 2015 Igor Bezkrovny
 * All rights reserved. (MIT Licensed)
 *
 * ssim.ts - part of Image Quantization Library
 */const Y=4;function $(t,n,c=8,a=.01,e=.03,r=!0,o=8){if(t.width!==n.width||t.height!==n.height)throw new Error("Images have different sizes!");const l=(1<<o)-1,m=Math.pow(a*l,2),p=Math.pow(e*l,2);let g=0,i=0,f=0;function h(x,y,w,s){let u,E,b;u=E=b=0;for(let M=0;M<x.length;M++)E+=Math.pow(x[M]-w,2),b+=Math.pow(y[M]-s,2),u+=(x[M]-w)*(y[M]-s);const A=x.length-1;E/=A,b/=A,u/=A;const N=(2*w*s+m)*(2*u+p),O=(Math.pow(w,2)+Math.pow(s,2)+m)*(E+b+p);i+=N/O,f+=(2*u+p)/(E+b+p),g++}return P._iterate(t,n,c,r,h),{ssim:i/g,mcs:f/g}}var P;(t=>{function n(e,r,o,l,m){const p=e.width,g=e.height;for(let i=0;i<g;i+=o)for(let f=0;f<p;f+=o){const h=Math.min(o,p-f),x=Math.min(o,g-i),y=c(e,f,i,h,x,l),w=c(r,f,i,h,x,l),s=a(y),u=a(w);m(y,w,s,u)}}t._iterate=n;function c(e,r,o,l,m,p,g=Y){const i=e.data,f=new Float32Array(new ArrayBuffer(l*m*4));let h=0;const x=o+m;for(let y=o;y<x;y++){const w=y*e.width;let s=(w+r)*g;const u=(w+r+l)*g;switch(g){case 1:for(;s<u;)f[h++]=i[s++];break;case 2:for(;s<u;)f[h++]=i[s++]*(i[s++]/255);break;case 3:if(p)for(;s<u;)f[h++]=i[s++]*.212655+i[s++]*.715158+i[s++]*.072187;else for(;s<u;)f[h++]=i[s++]+i[s++]+i[s++];break;case 4:if(p)for(;s<u;)f[h++]=(i[s++]*.212655+i[s++]*.715158+i[s++]*.072187)*(i[s++]/255);else for(;s<u;)f[h++]=(i[s++]+i[s++]+i[s++])*(i[s++]/255);break}}return f}function a(e){let r=0;for(let o=0;o<e.length;o++)r+=e[o];return r/e.length}})(P||(P={}));function J(t,n){let c=-1/0,a;for(const e of t){const r=n(e);r>c&&(c=r,a=e)}return{element:a,score:c}}const Q=10,X=9;function D(t){return Array.from({length:t})}function z(){return D(X).map(T)}function V(t){return n=>{const c=K(n.face);return $(c,t).ssim}}async function tt(){const t=D(Q).map(z),n=await Promise.all(t.map(G));return t.map((c,a)=>({face:n[a],chromosome:c}))}async function et(){const t=await H("face-2.jpg"),n=await tt();return{bestFit:J(n,V(t)),population:n}}const nt=.5;function rt(){const t=L(()=>et());return F(W,{children:[F("h2",{children:["Winner ",t.bestFit.score]}),I(S,{image:t.bestFit.element.face,scale:nt}),I("h2",{children:"Population"}),I("div",{children:t.population.map(n=>I(S,{image:n.face,scale:.2}))})]})}R.exports.render(I(v.exports.StrictMode,{children:I(v.exports.Suspense,{fallback:I("div",{children:"loading..."}),children:I(rt,{})})}),document.getElementById("root"));
