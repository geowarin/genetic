var J=Object.defineProperty,Q=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var T=(e,t,a)=>t in e?J(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,B=(e,t)=>{for(var a in t||(t={}))Y.call(t,a)&&T(e,a,t[a]);if(D)for(var a of D(t))V.call(t,a)&&T(e,a,t[a]);return e},F=(e,t)=>Q(e,X(t));import{j as S,r as P,n as ee,a as _,u as te,c as A,b as ne}from"./vendor.e497214e.js";const ae=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}};ae();const f=1024,W=20,G=10,q=9,re=4,L=5,oe=.2,l=S.exports.jsx,x=S.exports.jsxs,se=S.exports.Fragment;function ie({image:e,scale:t=1}){const a=P.exports.useRef(null);return P.exports.useEffect(()=>{const o=a.current;if(o===null)return;const n=o.getContext("2d");n.scale(t,t),n.drawImage(e.canvas,0,0),n.resetTransform()},[a]),l("canvas",{ref:a,width:f*t,height:f*t})}function H(){const e=document.createElement("canvas");return e.width=f,e.height=f,e.getContext("2d")}function ce(e){return U(e,{x:0,y:0,width:f,height:f})}function U(e,{x:t,y:a,width:o,height:n}){return new Promise(r=>{const s=new Image;s.onload=()=>{const u=H();u.drawImage(s,0,0,f,f);const d=u.getImageData(t,a,o,n);r(d)},s.src=e})}function le(e){return`face-${e}.jpg`}function ue(e){const t=H(),a=e.length,o=he(a),n=o.map((r,s)=>U(le(e[s]),r));return Promise.all(n).then(r=>{for(let s=0;s<a;s++){const{y:u,x:d}=o[s];t.putImageData(r[s],d,u)}return t})}function he(e){const t=Math.sqrt(e),a=f/t;return Array.from({length:e}).map((o,n)=>{const r=Math.floor(n/t),s=n%t;return{x:r*a,y:s*a,width:a,height:a}})}function de(e){return e.getImageData(0,0,f,f)}/**
 * @preserve
 * Copyright 2015 Igor Bezkrovny
 * All rights reserved. (MIT Licensed)
 *
 * ssim.ts - part of Image Quantization Library
 */const me=3;function pe(e,t,a=8,o=.01,n=.03,r=!0,s=8){if(e.width!==t.width||e.height!==t.height)throw new Error("Images have different sizes!");const u=(1<<s)-1,d=Math.pow(o*u,2),g=Math.pow(n*u,2);let b=0,c=0,h=0;function p(y,k,w,i){let m,N,I;m=N=I=0;for(let v=0;v<y.length;v++)N+=Math.pow(y[v]-w,2),I+=Math.pow(k[v]-i,2),m+=(y[v]-w)*(k[v]-i);const z=y.length-1;N/=z,I/=z,m/=z;const K=(2*w*i+d)*(2*m+g),$=(Math.pow(w,2)+Math.pow(i,2)+d)*(N+I+g);c+=K/$,h+=(2*m+g)/(N+I+g),b++}return j._iterate(e,t,a,r,p),{ssim:c/b,mcs:h/b}}var j;(e=>{function t(n,r,s,u,d){const g=n.width,b=n.height;for(let c=0;c<b;c+=s)for(let h=0;h<g;h+=s){const p=Math.min(s,g-h),y=Math.min(s,b-c),k=a(n,h,c,p,y,u),w=a(r,h,c,p,y,u),i=o(k),m=o(w);d(k,w,i,m)}}e._iterate=t;function a(n,r,s,u,d,g,b=me){const c=n.data,h=new Float32Array(new ArrayBuffer(u*d*4));let p=0;const y=s+d;for(let k=s;k<y;k++){const w=k*n.width;let i=(w+r)*b;const m=(w+r+u)*b;switch(b){case 1:for(;i<m;)h[p++]=c[i++];break;case 2:for(;i<m;)h[p++]=c[i++]*(c[i++]/255);break;case 3:if(g)for(;i<m;)h[p++]=c[i++]*.212655+c[i++]*.715158+c[i++]*.072187;else for(;i<m;)h[p++]=c[i++]+c[i++]+c[i++];break;case 4:if(g)for(;i<m;)h[p++]=(c[i++]*.212655+c[i++]*.715158+c[i++]*.072187)*(c[i++]/255);else for(;i<m;)h[p++]=(c[i++]+c[i++]+c[i++])*(c[i++]/255);break}}return h}function o(n){let r=0;for(let s=0;s<n.length;s++)r+=n[s];return r/n.length}})(j||(j={}));const fe=["aardvark","abacus","abundance","ache","acupuncture","airbrush","alien","anagram","angle","amazing","ankle","alphabet","antenna","aqua","asphalt","bacon","banana","bangles","banjo","bankrupt","bar","barracuda","basket","beluga","binder","birthday","bisect","blizzard","blunderbuss","boa","bog","bounce","broomstick","brought","bubble","budgie","bug","bug-a-boo","bugger","buff","burst","butter","buzz","cabana","cake","calculator","camera","candle","carnival","carpet","casino","cashew","catfish","ceiling","celery","chalet","chalk","chart","cheddar","chesterfield","chicken","chinchill","chit-chat","chocolate","chowder","coal","compass","compress","computer","conduct","contents","cookie","copper","corduroy","cow","cracker","crackle","croissant","cube","cupcake","curly","curtain","cushion","cuticle","daffodil","delicious","dictionary","dimple","ding-a-ling","disk","disco duck","dodo","dolphin","dong","donuts","dork","dracula","duct tape","effigy","egad","elastic","elephant","encasement","erosion","eyelash","fabulous","fantastic","feather","felafel","fetish","financial","finger","finite","fish","fizzle","fizzy","flame","flash","flavour","flick","flock","flour","flower","foamy","foot","fork","fritter","fudge","fungus","funny","fuse","fusion","fuzzy","garlic","gelatin","gelato","ghetto","glebe","glitter","glossy","groceries","goulashes","guacamole","gumdrop","haberdashery","hamster","happy","highlight","hippopotamus","hobbit","hold","hooligan","hydrant","icicles","idiot","implode","implosion","indeed","issue","itchy","jell-o","jewel","jump","kabob","kasai","kite","kiwi","ketchup","knob","laces","lacy","laughter","laundry","leaflet","legacy","leprechaun","lollypop","lumberjack","macadamia","magenta","magic","magnanimous","mango","margarine","massimo","mechanical","medicine","meh","melon","meow","mesh","metric","microphone","minnow","mitten","mozzarella","muck","mumble","mushy","mustache","nanimo","noodle","nostril","nuggets","oatmeal","oboe","o'clock","octopus","odour","ointment","olive","optic","overhead","ox","oxen","pajamas","pancake","pansy","paper","paprika","parmesan","pasta","pattern","pecan","peek-a-boo","pen","pepper","pepperoni","peppermint","perfume","periwinkle","photograph","pie","pierce","pillow","pimple","pineapple","pistachio","plush","polish","pompom","poodle","pop","popsicle","prism","prospector","prosper","pudding","puppet","puzzle","queer","query","radish","rainbow","ribbon","rotate","salami","sandwich","saturday","saturn","saxophone","scissors","scooter","scrabbleship","scrunchie","scuffle","shadow","sickish","silicone","slippery","smash","smooch","snap","snooker","socks","soya","spaghett","sparkle","spatula","spiral","splurge","spoon","sprinkle","square","squiggle","squirrel","statistics","stuffing","sticky","sugar","sunshine","super","swirl","taffy","tangy","tape","tat","teepee","telephone","television","thinkable","tip","tof","toga","trestle","tulip","turnip","turtle","tusks","ultimate","unicycle","unique","uranus","vegetable","waddle","waffle","wallet","walnut","wagon","window","whatever","whimsical","wobbly","yellow","zap","zebra","zigzag","zip"];function M(e,t){return Math.floor(Math.random()*(t-e+1))+e}function ge(){return M(1,W)}function O(e){return e[M(0,e.length-1)]}function Z(){return O(fe)}function C(e){return Array.from({length:e})}function be(){return C(q).map(ge)}function we(){const e=C(G).map(be);return Promise.all(e.map(t=>R(Z(),t)))}function R(e,t){return ue(t).then(a=>({face:a,chromosome:t,id:ee(),name:e}))}function ye(e){return t=>t.map(a=>F(B({},a),{rating:e(a)}))}function ke(e){return t=>{const a=de(t.face);return pe(a,e).ssim}}function xe(e){return _(e).sortedByDescending(t=>t.rating).take(re).toArray()}async function ve(e){const t=_(e).chunk(2).flatMap(([a,o])=>{const n=C(q).map((u,d)=>Math.random()>.5?a.chromosome[d]:o.chromosome[d]),r=O(a.name.split(" ")),s=O(o.name.split(" "));return R(r+" "+s,n)});return Promise.all(t)}function Ne(e){return _(e).sortedByDescending(t=>t.rating).take(G).toArray()}function Ie(e){return Promise.all(_(e).filter(t=>Math.random()<=oe).map(t=>{const a=M(0,q-1),o=[...t.chromosome];return o[a]=M(1,W),R(Z(),o)}).toArray())}async function Pe(e,t){const a=xe(t),o=e(await ve(a)),n=e(await Ie(t)),r=Ne([...t,...n,...o]);return{population:t,selected:a,children:o,mutants:n,newPopulation:r}}async function Me(e=1){const t=await ce("face-2.jpg"),a=await we(),o=ye(ke(t)),n=[];let r=o(a);for(let s=0;s<e;s++){const u=await Pe(o,r);n.push(u),r=u.newPopulation}return n}function _e(){const[e,t]=P.exports.useState(0),o=te(()=>Me(L))[e];return x(se,{children:[x("h2",{children:["Generation ",e]}),l("div",{children:l("input",{type:"range",min:"0",max:L-1,value:e,onChange:n=>t(parseInt(n.target.value))})}),x("div",{className:"result-container",children:[x("div",{className:"results",style:{maxWidth:"50%"},children:[l("h2",{children:"Population"}),l("div",{className:"portraits",children:o.population.map(n=>l(E,{person:n,className:A({selected:o.newPopulation.includes(n)})},n.id))})]}),x("div",{className:"results",style:{maxWidth:"25%"},children:[l("h2",{children:"Children"}),l("div",{className:"portraits",children:o.children.map(n=>l(E,{person:n,className:A({selected:o.newPopulation.includes(n)})},n.id))})]}),x("div",{className:"results",children:[l("h2",{children:"Mutants"}),l("div",{className:"portraits",children:o.mutants.map(n=>l(E,{person:n,className:A({selected:o.newPopulation.includes(n)})},n.id))})]})]})]})}function E({person:e,className:t}){return x("div",{className:"portrait "+t,children:[l(ie,{image:e.face,scale:.2}),l("span",{children:e.name}),x("span",{children:[Math.ceil(e.rating*1e4)/100,"%"]})]})}ne.exports.render(l(P.exports.StrictMode,{children:l(P.exports.Suspense,{fallback:l("div",{children:"loading..."}),children:l(_e,{})})}),document.getElementById("root"));
