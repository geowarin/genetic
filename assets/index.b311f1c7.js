import{j as D,r as _,R as F,a as O}from"./vendor.551c6e3d.js";const k=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const e of n.addedNodes)e.tagName==="LINK"&&e.rel==="modulepreload"&&a(e)}).observe(document,{childList:!0,subtree:!0});function i(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(t){if(t.ep)return;t.ep=!0;const n=i(t);fetch(t.href,n)}};k();/**
 * @preserve
 * Copyright 2015 Igor Bezkrovny
 * All rights reserved. (MIT Licensed)
 *
 * ssim.ts - part of Image Quantization Library
 */const q=4;function W(r,c,i=8,a=.01,t=.03,n=!0,e=8){if(r.width!==c.width||r.height!==c.height)throw new Error("Images have different sizes!");const f=(1<<e)-1,u=Math.pow(a*f,2),d=Math.pow(t*f,2);let p=0,s=0,l=0;function m(x,I,w,o){let h,M,E;h=M=E=0;for(let y=0;y<x.length;y++)M+=Math.pow(x[y]-w,2),E+=Math.pow(I[y]-o,2),h+=(x[y]-w)*(I[y]-o);const R=x.length-1;M/=R,E/=R,h/=R;const S=(2*w*o+u)*(2*h+d),C=(Math.pow(w,2)+Math.pow(o,2)+u)*(M+E+d);s+=S/C,l+=(2*h+d)/(M+E+d),p++}return b._iterate(r,c,i,n,m),{ssim:s/p,mcs:l/p}}var b;(r=>{function c(t,n,e,f,u){const d=t.width,p=t.height;for(let s=0;s<p;s+=e)for(let l=0;l<d;l+=e){const m=Math.min(e,d-l),x=Math.min(e,p-s),I=i(t,l,s,m,x,f),w=i(n,l,s,m,x,f),o=a(I),h=a(w);u(I,w,o,h)}}r._iterate=c;function i(t,n,e,f,u,d,p=q){const s=t.data,l=new Float32Array(new ArrayBuffer(f*u*4));let m=0;const x=e+u;for(let I=e;I<x;I++){const w=I*t.width;let o=(w+n)*p;const h=(w+n+f)*p;switch(p){case 1:for(;o<h;)l[m++]=s[o++];break;case 2:for(;o<h;)l[m++]=s[o++]*(s[o++]/255);break;case 3:if(d)for(;o<h;)l[m++]=s[o++]*.212655+s[o++]*.715158+s[o++]*.072187;else for(;o<h;)l[m++]=s[o++]+s[o++]+s[o++];break;case 4:if(d)for(;o<h;)l[m++]=(s[o++]*.212655+s[o++]*.715158+s[o++]*.072187)*(s[o++]/255);else for(;o<h;)l[m++]=(s[o++]+s[o++]+s[o++])*(s[o++]/255);break}}return l}function a(t){let n=0;for(let e=0;e<t.length;e++)n+=t[e];return n/t.length}})(b||(b={}));const g=1024;function B(r){const c=Math.sqrt(r),i=g/c;return Array.from({length:r}).map((a,t)=>{const n=Math.floor(t/c),e=t%c;return{x:n*i,y:e*i,width:i,height:i}})}function L(){const r=document.createElement("canvas");return r.width=g,r.height=g,r.getContext("2d")}function H(r){return N(r,{x:0,y:0,width:g,height:g})}function N(r,{x:c,y:i,width:a,height:t}){return new Promise(n=>{const e=new Image;e.onload=()=>{const f=L();f.drawImage(e,0,0,g,g);const u=f.getImageData(c,i,a,t);n(u)},e.src=r})}function T(r){return`face-${r}.jpg`}function Z(r){const c=L(),i=r.length,a=B(i),t=a.map((n,e)=>N(T(r[e]),n));return Promise.all(t).then(n=>{for(let e=0;e<i;e++){const{y:f,x:u}=a[e];c.putImageData(n[e],u,f)}return c})}function G(r,c){return Math.floor(Math.random()*(c-r+1))+r}function j(){return G(1,20)}const A=D.exports.jsx,P=D.exports.jsxs,v=.5;function K(){const r=_.exports.useRef(null),[c,i]=_.exports.useState();return _.exports.useEffect(()=>{const a=r.current;if(a===null)return;const t=a.getContext("2d"),n=Z([j(),j(),j(),j()]);Promise.all([n,H("face-2.jpg")]).then(([e,f])=>{const u=e.getImageData(0,0,g,g),d=W(u,f);i(d),t.scale(v,v),t.drawImage(e.canvas,0,0)})},[r]),P("div",{children:[P("h2",{children:["Result ",c==null?void 0:c.ssim]}),A("canvas",{ref:r,width:g*v,height:g*v})]})}F.render(A(O.StrictMode,{children:A(K,{})}),document.getElementById("root"));
