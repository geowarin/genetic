var Z=Object.defineProperty,G=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var O=(e,t,n)=>t in e?Z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,C=(e,t)=>{for(var n in t||(t={}))$.call(t,n)&&O(e,n,t[n]);if(q)for(var n of q(t))J.call(t,n)&&O(e,n,t[n]);return e},D=(e,t)=>G(e,K(t));import{j as _,r as M,a as A,n as Q,b as X,u as Y,c as P,d as V}from"./vendor.942cc90e.js";const ee=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}};ee();const f=1024,te=20,u=_.exports.jsx,j=_.exports.jsxs,ne=_.exports.Fragment;function ae({image:e,scale:t=1}){const n=M.exports.useRef(null);return M.exports.useEffect(()=>{const c=n.current;if(c===null)return;const a=c.getContext("2d");a.scale(t,t),a.drawImage(e.canvas,0,0),a.resetTransform()},[n]),u("canvas",{ref:n,width:f*t,height:f*t})}const oe=["aardvark","abacus","abundance","ache","acupuncture","airbrush","alien","anagram","angle","amazing","ankle","alphabet","antenna","aqua","asphalt","bacon","banana","bangles","banjo","bankrupt","bar","barracuda","basket","beluga","binder","birthday","bisect","blizzard","blunderbuss","boa","bog","bounce","broomstick","brought","bubble","budgie","bug","bug-a-boo","bugger","buff","burst","butter","buzz","cabana","cake","calculator","camera","candle","carnival","carpet","casino","cashew","catfish","ceiling","celery","chalet","chalk","chart","cheddar","chesterfield","chicken","chinchill","chit-chat","chocolate","chowder","coal","compass","compress","computer","conduct","contents","cookie","copper","corduroy","cow","cracker","crackle","croissant","cube","cupcake","curly","curtain","cushion","cuticle","daffodil","delicious","dictionary","dimple","ding-a-ling","disk","disco duck","dodo","dolphin","dong","donuts","dork","dracula","duct tape","effigy","egad","elastic","elephant","encasement","erosion","eyelash","fabulous","fantastic","feather","felafel","fetish","financial","finger","finite","fish","fizzle","fizzy","flame","flash","flavour","flick","flock","flour","flower","foamy","foot","fork","fritter","fudge","fungus","funny","fuse","fusion","fuzzy","garlic","gelatin","gelato","ghetto","glebe","glitter","glossy","groceries","goulashes","guacamole","gumdrop","haberdashery","hamster","happy","highlight","hippopotamus","hobbit","hold","hooligan","hydrant","icicles","idiot","implode","implosion","indeed","issue","itchy","jell-o","jewel","jump","kabob","kasai","kite","kiwi","ketchup","knob","laces","lacy","laughter","laundry","leaflet","legacy","leprechaun","lollypop","lumberjack","macadamia","magenta","magic","magnanimous","mango","margarine","massimo","mechanical","medicine","meh","melon","meow","mesh","metric","microphone","minnow","mitten","mozzarella","muck","mumble","mushy","mustache","nanimo","noodle","nostril","nuggets","oatmeal","oboe","o'clock","octopus","odour","ointment","olive","optic","overhead","ox","oxen","pajamas","pancake","pansy","paper","paprika","parmesan","pasta","pattern","pecan","peek-a-boo","pen","pepper","pepperoni","peppermint","perfume","periwinkle","photograph","pie","pierce","pillow","pimple","pineapple","pistachio","plush","polish","pompom","poodle","pop","popsicle","prism","prospector","prosper","pudding","puppet","puzzle","queer","query","radish","rainbow","ribbon","rotate","salami","sandwich","saturday","saturn","saxophone","scissors","scooter","scrabbleship","scrunchie","scuffle","shadow","sickish","silicone","slippery","smash","smooch","snap","snooker","socks","soya","spaghett","sparkle","spatula","spiral","splurge","spoon","sprinkle","square","squiggle","squirrel","statistics","stuffing","sticky","sugar","sunshine","super","swirl","taffy","tangy","tape","tat","teepee","telephone","television","thinkable","tip","tof","toga","trestle","tulip","turnip","turtle","tusks","ultimate","unicycle","unique","uranus","vegetable","waddle","waffle","wallet","walnut","wagon","window","whatever","whimsical","wobbly","yellow","zap","zebra","zigzag","zip"];function S(e,t){return Math.floor(Math.random()*(t-e+1))+e}function re(){return S(1,te)}function se(e){return e[S(0,e.length-1)]}function ie(){return se(oe)}function F(){const e=document.createElement("canvas");return e.width=f,e.height=f,e.getContext("2d")}function ce(e){return L(e,{x:0,y:0,width:f,height:f})}function L(e,{x:t,y:n,width:c,height:a}){return new Promise(o=>{const r=new Image;r.onload=()=>{const h=F();h.drawImage(r,0,0,f,f);const d=h.getImageData(t,n,c,a);o(d)},r.src=e})}function le(e){return`face-${e}.jpg`}function ue(e){const t=F(),n=e.length,c=pe(n),a=c.map((o,r)=>L(le(e[r]),o));return Promise.all(a).then(o=>{for(let r=0;r<n;r++){const{y:h,x:d}=c[r];t.putImageData(o[r],d,h)}return t})}function pe(e){const t=Math.sqrt(e),n=f/t;return Array.from({length:e}).map((c,a)=>{const o=Math.floor(a/t),r=a%t;return{x:o*n,y:r*n,width:n,height:n}})}function he(e){return e.getImageData(0,0,f,f)}/**
 * @preserve
 * Copyright 2015 Igor Bezkrovny
 * All rights reserved. (MIT Licensed)
 *
 * ssim.ts - part of Image Quantization Library
 */const de=3;function me(e,t,n=8,c=.01,a=.03,o=!0,r=8){if(e.width!==t.width||e.height!==t.height)throw new Error("Images have different sizes!");const h=(1<<r)-1,d=Math.pow(c*h,2),g=Math.pow(a*h,2);let b=0,i=0,l=0;function m(w,k,y,s){let p,v,I;p=v=I=0;for(let x=0;x<w.length;x++)v+=Math.pow(w[x]-y,2),I+=Math.pow(k[x]-s,2),p+=(w[x]-y)*(k[x]-s);const N=w.length-1;v/=N,I/=N,p/=N;const H=(2*y*s+d)*(2*p+g),U=(Math.pow(y,2)+Math.pow(s,2)+d)*(v+I+g);i+=H/U,l+=(2*p+g)/(v+I+g),b++}return E._iterate(e,t,n,o,m),{ssim:i/b,mcs:l/b}}var E;(e=>{function t(a,o,r,h,d){const g=a.width,b=a.height;for(let i=0;i<b;i+=r)for(let l=0;l<g;l+=r){const m=Math.min(r,g-l),w=Math.min(r,b-i),k=n(a,l,i,m,w,h),y=n(o,l,i,m,w,h),s=c(k),p=c(y);d(k,y,s,p)}}e._iterate=t;function n(a,o,r,h,d,g,b=de){const i=a.data,l=new Float32Array(new ArrayBuffer(h*d*4));let m=0;const w=r+d;for(let k=r;k<w;k++){const y=k*a.width;let s=(y+o)*b;const p=(y+o+h)*b;switch(b){case 1:for(;s<p;)l[m++]=i[s++];break;case 2:for(;s<p;)l[m++]=i[s++]*(i[s++]/255);break;case 3:if(g)for(;s<p;)l[m++]=i[s++]*.212655+i[s++]*.715158+i[s++]*.072187;else for(;s<p;)l[m++]=i[s++]+i[s++]+i[s++];break;case 4:if(g)for(;s<p;)l[m++]=(i[s++]*.212655+i[s++]*.715158+i[s++]*.072187)*(i[s++]/255);else for(;s<p;)l[m++]=(i[s++]+i[s++]+i[s++])*(i[s++]/255);break}}return l}function c(a){let o=0;for(let r=0;r<a.length;r++)o+=a[r];return o/a.length}})(E||(E={}));const R=10,B=9,fe=6;function T(e){return Array.from({length:e})}function ge(){return T(B).map(re)}function be(e){return t=>{const n=he(t.face);return me(n,e).ssim}}async function ye(){const e=T(R).map(ge);return Promise.all(e.map(t=>W(ie(),t)))}function we(e){return A(e).sortedByDescending(t=>t.rating).take(fe).toArray()}function W(e,t){return ue(t).then(n=>({face:n,chromosome:t,id:Q(),name:e}))}async function ke(e){const t=A(e).chunk(2).flatMap(([n,c])=>{const a=X(0,B-1).map(o=>Math.random()>.5?n.chromosome[o]:c.chromosome[o]).toArray();return W(n.name+" "+c.name,a)});return Promise.all(t)}function xe(e){return A(e).sortedByDescending(t=>t.rating).take(R).toArray()}function ve(e){return[]}function Ie(e){return t=>t.map(n=>D(C({},n),{rating:e(n)}))}async function Me(){const e=await ce("face-2.jpg"),t=Ie(be(e)),n=t(await ye()),c=we(n),a=t(await ke(c)),o=t(ve()),r=xe([...n,...o,...a]);return{population:n,selected:c,children:a,mutants:o,newPopulation:r}}function Ne(){const e=Y(()=>Me());return j(ne,{children:[u("h2",{children:"Population"}),u("div",{className:"portraits",children:e.population.map(t=>u(z,{person:t,className:P({selected:e.newPopulation.includes(t)})},t.id))}),u("h2",{children:"Children"}),u("div",{className:"portraits",children:e.children.map(t=>u(z,{person:t,className:P({selected:e.newPopulation.includes(t)})},t.id))}),u("h2",{children:"Mutants"}),u("div",{className:"portraits",children:e.mutants.map(t=>u(z,{person:t,className:P({selected:e.newPopulation.includes(t)})},t.id))})]})}function z({person:e,className:t}){return j("div",{className:"portrait "+t,children:[u(ae,{image:e.face,scale:.2}),u("span",{children:e.name}),j("span",{children:[Math.ceil(e.rating*1e4)/100,"%"]})]})}V.exports.render(u(M.exports.StrictMode,{children:u(M.exports.Suspense,{fallback:u("div",{children:"loading..."}),children:u(Ne,{})})}),document.getElementById("root"));
