import{j as C,r as E,u as P,a as R}from"./vendor.a536db46.js";const k=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function i(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(t){if(t.ep)return;t.ep=!0;const o=i(t);fetch(t.href,o)}};k();/**
 * @preserve
 * Copyright 2015 Igor Bezkrovny
 * All rights reserved. (MIT Licensed)
 *
 * ssim.ts - part of Image Quantization Library
 */const O=4;function q(e,s,i=8,a=.01,t=.03,o=!0,n=8){if(e.width!==s.width||e.height!==s.height)throw new Error("Images have different sizes!");const l=(1<<n)-1,h=Math.pow(a*l,2),g=Math.pow(t*l,2);let p=0,c=0,f=0;function d(x,y,w,r){let u,v,A;u=v=A=0;for(let I=0;I<x.length;I++)v+=Math.pow(x[I]-w,2),A+=Math.pow(y[I]-r,2),u+=(x[I]-w)*(y[I]-r);const b=x.length-1;v/=b,A/=b,u/=b;const L=(2*w*r+h)*(2*u+g),N=(Math.pow(w,2)+Math.pow(r,2)+h)*(v+A+g);c+=L/N,f+=(2*u+g)/(v+A+g),p++}return j._iterate(e,s,i,o,d),{ssim:c/p,mcs:f/p}}var j;(e=>{function s(t,o,n,l,h){const g=t.width,p=t.height;for(let c=0;c<p;c+=n)for(let f=0;f<g;f+=n){const d=Math.min(n,g-f),x=Math.min(n,p-c),y=i(t,f,c,d,x,l),w=i(o,f,c,d,x,l),r=a(y),u=a(w);h(y,w,r,u)}}e._iterate=s;function i(t,o,n,l,h,g,p=O){const c=t.data,f=new Float32Array(new ArrayBuffer(l*h*4));let d=0;const x=n+h;for(let y=n;y<x;y++){const w=y*t.width;let r=(w+o)*p;const u=(w+o+l)*p;switch(p){case 1:for(;r<u;)f[d++]=c[r++];break;case 2:for(;r<u;)f[d++]=c[r++]*(c[r++]/255);break;case 3:if(g)for(;r<u;)f[d++]=c[r++]*.212655+c[r++]*.715158+c[r++]*.072187;else for(;r<u;)f[d++]=c[r++]+c[r++]+c[r++];break;case 4:if(g)for(;r<u;)f[d++]=(c[r++]*.212655+c[r++]*.715158+c[r++]*.072187)*(c[r++]/255);else for(;r<u;)f[d++]=(c[r++]+c[r++]+c[r++])*(c[r++]/255);break}}return f}function a(t){let o=0;for(let n=0;n<t.length;n++)o+=t[n];return o/t.length}})(j||(j={}));const m=1024,W=20;function F(){const e=document.createElement("canvas");return e.width=m,e.height=m,e.getContext("2d")}function B(e){return S(e,{x:0,y:0,width:m,height:m})}function S(e,{x:s,y:i,width:a,height:t}){return new Promise(o=>{const n=new Image;n.onload=()=>{const l=F();l.drawImage(n,0,0,m,m);const h=l.getImageData(s,i,a,t);o(h)},n.src=e})}function T(e){return`face-${e}.jpg`}function H(e){const s=F(),i=e.length,a=Z(i),t=a.map((o,n)=>S(T(e[n]),o));return Promise.all(t).then(o=>{for(let n=0;n<i;n++){const{y:l,x:h}=a[n];s.putImageData(o[n],h,l)}return s})}function Z(e){const s=Math.sqrt(e),i=m/s;return Array.from({length:e}).map((a,t)=>{const o=Math.floor(t/s),n=t%s;return{x:o*i,y:n*i,width:i,height:i}})}function G(e){return e.getImageData(0,0,m,m)}function K(e,s){return Math.floor(Math.random()*(s-e+1))+e}function _(){return K(1,W)}function U(){return[_(),_(),_(),_()]}const M=C.exports.jsx,D=C.exports.jsxs,Y=C.exports.Fragment;function $({image:e,scale:s=1}){const i=E.exports.useRef(null);return E.exports.useEffect(()=>{const a=i.current;if(a===null)return;const t=a.getContext("2d");t.scale(s,s),t.drawImage(e.canvas,0,0),t.resetTransform()},[i]),M("canvas",{ref:i,width:m*s,height:m*s})}const J=.5;function Q(){const[e,s]=E.exports.useState(),[i,a]=P(async()=>[await H(U()),await B("face-2.jpg")]);return E.exports.useEffect(()=>{const t=q(G(i),a);s(t)},[a]),D(Y,{children:[D("h2",{children:["Result ",e==null?void 0:e.ssim]}),M($,{image:i,scale:J})]})}R.exports.render(M(E.exports.StrictMode,{children:M(E.exports.Suspense,{fallback:M("div",{children:"loading..."}),children:M(Q,{})})}),document.getElementById("root"));
