import{j as S,r as b,R as B,a as F}from"./vendor.551c6e3d.js";const G=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function u(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(t){if(t.ep)return;t.ep=!0;const o=u(t);fetch(t.href,o)}};G();function L(r,c){return Math.floor(Math.random()*(c-r+1))+r}function T(){return`face-${L(1,20)}.jpg`}/**
 * @preserve
 * Copyright 2015 Igor Bezkrovny
 * All rights reserved. (MIT Licensed)
 *
 * ssim.ts - part of Image Quantization Library
 */function W(r,c,u=8,i=.01,t=.03,o=!0,n=8){if(r.width!==c.width||r.height!==c.height)throw new Error("Images have different sizes!");var a=(1<<n)-1,d=Math.pow(i*a,2),p=Math.pow(t*a,2),s=0,h=0,f=0;function I(g,v,e,l){var w,M,x;w=M=x=0;for(var y=0;y<g.length;y++)M+=Math.pow(g[y]-e,2),x+=Math.pow(v[y]-l,2),w+=(g[y]-e)*(v[y]-l);var _=g.length-1;M/=_,x/=_,w/=_;var C=(2*e*l+d)*(2*w+p),q=(Math.pow(e,2)+Math.pow(l,2)+d)*(M+x+p);h+=C/q,f+=(2*w+p)/(M+x+p),s++}return j._iterate(r,c,u,o,I),{ssim:h/s,mcs:f/s}}var j;(r=>{function c(t,o,n,a,d){for(var p=t.width,s=t.height,h=0;h<s;h+=n)for(var f=0;f<p;f+=n){var I=Math.min(n,p-f),g=Math.min(n,s-h),v=u(t,f,h,I,g,a),e=u(o,f,h,I,g,a),l=i(v),w=i(e);d(v,e,l,w)}}r._iterate=c;function u(t,o,n,a,d,p){for(var s=t.data,h=new Float32Array(new ArrayBuffer(a*d*4)),f=0,I=n+d,g=n;g<I;g++){var v=g*t.width,e=(v+o)*t.channels,l=(v+o+a)*t.channels;switch(t.channels){case 1:for(;e<l;)h[f++]=s[e++];break;case 2:for(;e<l;)h[f++]=s[e++]*(s[e++]/255);break;case 3:if(p)for(;e<l;)h[f++]=s[e++]*.212655+s[e++]*.715158+s[e++]*.072187;else for(;e<l;)h[f++]=s[e++]+s[e++]+s[e++];break;case 4:if(p)for(;e<l;)h[f++]=(s[e++]*.212655+s[e++]*.715158+s[e++]*.072187)*(s[e++]/255);else for(;e<l;)h[f++]=(s[e++]+s[e++]+s[e++])*(s[e++]/255);break}}return h}function i(t){for(var o=0,n=0;n<t.length;n++)o+=t[n];return o/t.length}})(j||(j={}));const P=S.exports.jsx,D=S.exports.jsxs,m=1024,E=4,A=E*E,R=m/E,N=Array.from({length:A}).map((r,c)=>{const u=Math.floor(c/E),i=c%E;return{x:u*R,y:i*R,width:R,height:R}});function Z(){const r=b.exports.useRef(null),[c,u]=b.exports.useState();return b.exports.useEffect(()=>{const i=r.current;if(i===null)return;const t=i.getContext("2d"),o=N.map(n=>k(T(),n));Promise.all(o).then(n=>{for(let a=0;a<A;a++){const{y:d,x:p}=N[a];t.putImageData(n[a],p,d)}}).then(()=>{const n=t.getImageData(0,0,m,m);$("face-2.jpg").then(O).then(a=>{const d=W(O(n),a);u(d)})})},[r]),D("div",{children:[D("h2",{children:["Result ",c==null?void 0:c.ssim]}),P("canvas",{ref:r,width:m,height:m})]})}function K(){const r=document.createElement("canvas");return r.width=m,r.height=m,r.getContext("2d")}function O(r){return{width:r.width,height:r.height,data:r.data,channels:4}}function $(r){return k(r,{x:0,y:0,width:m,height:m})}function k(r,{x:c,y:u,width:i,height:t}){return new Promise(o=>{const n=new Image;n.onload=()=>{const a=K();a.drawImage(n,0,0,m,m);const d=a.getImageData(c,u,i,t);o(d)},n.src=r})}B.render(P(F.StrictMode,{children:P(Z,{})}),document.getElementById("root"));
